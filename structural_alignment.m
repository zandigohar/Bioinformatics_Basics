% Q3
clc; close all; clear;

A=[-18.182	-16.251	26.007
    -17.72	-14.903	25.695
    -16.459	-14.888	24.836
    -15.542	-15.683	25.036
    -17.453	-14.118	26.978
    -17.439	-12.727	26.719
    -16.436	-13.963	23.882
    -15.329	-13.775	22.954
    -14.688	-12.453	23.351
    -13.517	-12.407	23.704
    ]';

B=[
    60.386	14.257	9.114
    61.404	14.873	9.964
    62.316	13.812	10.565
    62.09	12.614	10.388
    60.743	15.678	11.083
    59.352	16.118	10.759
    59.076	17.34	10.182
    58.161	15.487	10.894
    57.771	17.441	9.975
    57.198	16.331	10.398
    ]';


N=length(A(1,:));
for i=1:3
    muA(i,1)=sum(A(i,:))/N;
    muB(i,1)=sum(B(i,:))/N;
end

Ap=A-muA;
Bp=B-muB;

C=Ap*Bp';
[ U , D , V ] = svd( C );
detC=det(C); %det(C)<0
S=diag([1,1,-1]);
R=U*S*V';


t=-R*muA*N+muB*N;

